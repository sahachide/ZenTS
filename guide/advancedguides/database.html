<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Database / ORM | ZenTS - Node.js &amp; TypeScript MVC-Framework for building rich web applications</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" size="57x57" href="/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" size="60x60" href="/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" size="72x72" href="/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" size="76x76" href="/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" size="114x114" href="/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" size="120x120" href="/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" size="144x144" href="/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" size="152x152" href="/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" size="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" size="192x192" href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" size="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" size="96x96" href="/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" size="16x16" href="/favicon/favicon-16x16.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600;700;800&amp;family=Raleway:wght@400;500;600;700;800;900&amp;display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <script>                
        window.addEventListener('load', function () {
          var inputSelector = '.search-box > input';
          var $el = document.querySelector(inputSelector);

          if($el) {          
            $el.disabled = true;
            $el.placeholder = 'Loading...';
  
            var script = document.createElement("script");
            script.addEventListener("load", function() {
              docsearch({
                apiKey: '1c03de24a87faf1bfd8b7e760c63b3ab',
                indexName: 'zents',
                inputSelector: inputSelector,
              });
              $el.disabled = false;
              $el.placeholder = 'Search...';
            });
  
            script.src = "https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js";
  
            document.body.appendChild(script);            
          }
        });
      </script>
    <meta name="description" content="ZenTS is a Node.js & TypeScript MVC-Framework for building rich web applications, released as free and open-source software under the MIT License. It is designed for building web applications with modern tools and design patterns.">
    <meta name="keywords" content="ZenTS guide tutorial documentation database framework mvc TypeScript MySQL PostgreSQL SQLite MSSQL SQL.js MongoDB">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#512DA8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.5f5f71b9.css" as="style"><link rel="preload" href="/assets/js/app.ff0d6eb6.js" as="script"><link rel="preload" href="/assets/js/2.1831a849.js" as="script"><link rel="preload" href="/assets/js/16.d701e551.js" as="script"><link rel="preload" href="/assets/js/4.be0fa7c4.js" as="script"><link rel="prefetch" href="/assets/js/10.f60de0dc.js"><link rel="prefetch" href="/assets/js/11.f70646e3.js"><link rel="prefetch" href="/assets/js/12.7d400f46.js"><link rel="prefetch" href="/assets/js/13.75ca8dc6.js"><link rel="prefetch" href="/assets/js/14.53bbd6c1.js"><link rel="prefetch" href="/assets/js/15.485b7772.js"><link rel="prefetch" href="/assets/js/17.e2a1a4bc.js"><link rel="prefetch" href="/assets/js/18.279c874a.js"><link rel="prefetch" href="/assets/js/19.bd5220e3.js"><link rel="prefetch" href="/assets/js/20.9bbbcf25.js"><link rel="prefetch" href="/assets/js/21.8bbbd12a.js"><link rel="prefetch" href="/assets/js/22.46e6349d.js"><link rel="prefetch" href="/assets/js/23.403bfdcc.js"><link rel="prefetch" href="/assets/js/24.1c0b9c00.js"><link rel="prefetch" href="/assets/js/25.1d5dbc6b.js"><link rel="prefetch" href="/assets/js/26.dcb85366.js"><link rel="prefetch" href="/assets/js/27.86601334.js"><link rel="prefetch" href="/assets/js/28.ac72a169.js"><link rel="prefetch" href="/assets/js/29.04ae9240.js"><link rel="prefetch" href="/assets/js/3.656260b0.js"><link rel="prefetch" href="/assets/js/30.24ce4d2b.js"><link rel="prefetch" href="/assets/js/5.61ba91d2.js"><link rel="prefetch" href="/assets/js/6.1b9fb03d.js"><link rel="prefetch" href="/assets/js/7.379d2cb5.js"><link rel="prefetch" href="/assets/js/8.630c86f7.js"><link rel="prefetch" href="/assets/js/9.3cbbae49.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5f5f71b9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/zents_logo_icon.png" alt="ZenTS - Node.js &amp; TypeScript MVC-Framework for building rich web applications" class="logo"> <span class="site-name can-hide">ZenTS - Node.js &amp; TypeScript MVC-Framework for building rich web applications</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/configuration.html" class="nav-link">
  Configuration
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API Reference
</a></div><div class="nav-item"><a href="/cli.html" class="nav-link">
  CLI
</a></div><div class="nav-item"><a href="/roadmap.html" class="nav-link">
  Roadmap
</a></div> <a href="https://github.com/sahachide/ZenTS" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/configuration.html" class="nav-link">
  Configuration
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API Reference
</a></div><div class="nav-item"><a href="/cli.html" class="nav-link">
  CLI
</a></div><div class="nav-item"><a href="/roadmap.html" class="nav-link">
  Roadmap
</a></div> <a href="https://github.com/sahachide/ZenTS" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/gettingstarted/installation.html" class="sidebar-link">Installation &amp; Setup</a></li><li><a href="/guide/gettingstarted/helloworld.html" class="sidebar-link">Hello World Example</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Advanced Guides</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/advancedguides/controllers.html" class="sidebar-link">Controllers</a></li><li><a href="/guide/advancedguides/request.html" class="sidebar-link">Request Context</a></li><li><a href="/guide/advancedguides/response.html" class="sidebar-link">Response Context</a></li><li><a href="/guide/advancedguides/routing.html" class="sidebar-link">Routing</a></li><li><a href="/guide/advancedguides/database.html" aria-current="page" class="active sidebar-link">Database / ORM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#installing-a-driver" class="sidebar-link">Installing a driver</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#creating-entities" class="sidebar-link">Creating entities</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#specifying-column-types" class="sidebar-link">Specifying column types</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#column-options" class="sidebar-link">Column options</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#primary-key-column" class="sidebar-link">Primary key column</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#auto-increment-serial-column" class="sidebar-link">Auto increment / serial column</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#declaring-enum-column-type" class="sidebar-link">Declaring enum column type</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#declaring-set-column-types" class="sidebar-link">Declaring set column types</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#special-column-types-simple-array-simple-json" class="sidebar-link">Special column types (simple-array &amp; simple-json)</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#auto-generated-values" class="sidebar-link">Auto generated values</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#accessing-orm-in-a-controller-or-service" class="sidebar-link">Accessing ORM in a controller or service</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#injecting-the-connection" class="sidebar-link">Injecting the connection</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#injecting-the-entity-manager" class="sidebar-link">Injecting the Entity Manager</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#persisting-records-to-the-database" class="sidebar-link">Persisting records to the database</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#fetching-records-from-the-database-with-repositories" class="sidebar-link">Fetching records from the database with repositories</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#find-all-records" class="sidebar-link">Find all records</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#find-specific-records" class="sidebar-link">Find specific records</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#find-one-record" class="sidebar-link">Find one record</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#find-record-s-by-id" class="sidebar-link">Find record(s) by id</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#find-and-count" class="sidebar-link">Find and count</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#find-methods-options-and-conditions" class="sidebar-link">Find methods options and conditions</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#updating-a-record" class="sidebar-link">Updating a record</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#deleting-a-record" class="sidebar-link">Deleting a record</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#working-with-relationships" class="sidebar-link">Working with relationships</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#many-to-one-one-to-many-relationships" class="sidebar-link">many-to-one / one-to-many relationships</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#many-to-many-relationship" class="sidebar-link">many-to-many relationship</a></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#one-to-one-relationship" class="sidebar-link">one-to-one relationship</a></li></ul></li><li class="sidebar-sub-header"><a href="/guide/advancedguides/database.html#next-steps" class="sidebar-link">Next steps</a></li></ul></li><li><a href="/guide/advancedguides/redis.html" class="sidebar-link">Redis</a></li><li><a href="/guide/advancedguides/user_management.html" class="sidebar-link">User and Session Management</a></li><li><a href="/guide/advancedguides/templates.html" class="sidebar-link">Views &amp; Templates</a></li><li><a href="/guide/advancedguides/static_files.html" class="sidebar-link">Static files</a></li><li><a href="/guide/advancedguides/services.html" class="sidebar-link">Services</a></li><li><a href="/guide/advancedguides/dependency_injection.html" class="sidebar-link">Dependency Injection</a></li><li><a href="/guide/advancedguides/emails.html" class="sidebar-link">Sending emails</a></li></ul></section></li><li><a href="/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/cli.html" class="sidebar-link">Command-line interface (CLI)</a></li><li><a href="/roadmap.html" class="sidebar-link">Roadmap</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="frontmatter-title"><a href="#frontmatter-title" class="header-anchor">#</a> Database / ORM</h1> <div data-v-3d11b470><div class="reading-time" data-v-3d11b470>
    29 min read (5798 words)
  </div> <div class="illustration-container" data-v-3d11b470><img src="/guide/database.svg" class="illustration-image" data-v-3d11b470></div> <h2 data-v-3d11b470><a href="#" class="header-anchor" data-v-3d11b470>#</a> Table of contents</h2> <div data-v-3d11b470><p data-v-3d11b470></p><div class="table-of-contents" data-v-3d11b470><ul data-v-3d11b470><li data-v-3d11b470><a href="#introduction" data-v-3d11b470>Introduction</a></li><li data-v-3d11b470><a href="#installing-a-driver" data-v-3d11b470>Installing a driver</a></li><li data-v-3d11b470><a href="#configuration" data-v-3d11b470>Configuration</a></li><li data-v-3d11b470><a href="#creating-entities" data-v-3d11b470>Creating entities</a><ul data-v-3d11b470><li data-v-3d11b470><a href="#specifying-column-types" data-v-3d11b470>Specifying column types</a></li><li data-v-3d11b470><a href="#column-options" data-v-3d11b470>Column options</a></li><li data-v-3d11b470><a href="#primary-key-column" data-v-3d11b470>Primary key column</a></li><li data-v-3d11b470><a href="#auto-increment-serial-column" data-v-3d11b470>Auto increment / serial column</a></li><li data-v-3d11b470><a href="#declaring-enum-column-type" data-v-3d11b470>Declaring enum column type</a></li><li data-v-3d11b470><a href="#declaring-set-column-types" data-v-3d11b470>Declaring set column types</a></li><li data-v-3d11b470><a href="#special-column-types-simple-array-simple-json" data-v-3d11b470>Special column types (simple-array &amp; simple-json)</a><ul data-v-3d11b470><li data-v-3d11b470><a href="#simple-array" data-v-3d11b470>simple-array</a></li><li data-v-3d11b470><a href="#simple-json" data-v-3d11b470>simple-json</a></li></ul></li><li data-v-3d11b470><a href="#auto-generated-values" data-v-3d11b470>Auto generated values</a><ul data-v-3d11b470><li data-v-3d11b470><a href="#uuid" data-v-3d11b470>UUID</a></li><li data-v-3d11b470><a href="#increment" data-v-3d11b470>Increment</a></li></ul></li></ul></li><li data-v-3d11b470><a href="#accessing-orm-in-a-controller-or-service" data-v-3d11b470>Accessing ORM in a controller or service</a><ul data-v-3d11b470><li data-v-3d11b470><a href="#injecting-the-connection" data-v-3d11b470>Injecting the connection</a></li><li data-v-3d11b470><a href="#injecting-the-entity-manager" data-v-3d11b470>Injecting the Entity Manager</a></li></ul></li><li data-v-3d11b470><a href="#persisting-records-to-the-database" data-v-3d11b470>Persisting records to the database</a></li><li data-v-3d11b470><a href="#fetching-records-from-the-database-with-repositories" data-v-3d11b470>Fetching records from the database with repositories</a><ul data-v-3d11b470><li data-v-3d11b470><a href="#injecting-the-repository-into-a-method-recommend" data-v-3d11b470>Injecting the repository into a method (recommend)</a></li><li data-v-3d11b470><a href="#using-the-entitymanager-connection" data-v-3d11b470>Using the EntityManager / connection</a></li></ul><ul data-v-3d11b470><li data-v-3d11b470><a href="#find-all-records" data-v-3d11b470>Find all records</a></li><li data-v-3d11b470><a href="#find-specific-records" data-v-3d11b470>Find specific records</a></li><li data-v-3d11b470><a href="#find-one-record" data-v-3d11b470>Find one record</a></li><li data-v-3d11b470><a href="#find-record-s-by-id" data-v-3d11b470>Find record(s) by id</a></li><li data-v-3d11b470><a href="#find-and-count" data-v-3d11b470>Find and count</a></li><li data-v-3d11b470><a href="#find-methods-options-and-conditions" data-v-3d11b470>Find methods options and conditions</a></li></ul></li><li data-v-3d11b470><a href="#updating-a-record" data-v-3d11b470>Updating a record</a></li><li data-v-3d11b470><a href="#deleting-a-record" data-v-3d11b470>Deleting a record</a></li><li data-v-3d11b470><a href="#working-with-relationships" data-v-3d11b470>Working with relationships</a><ul data-v-3d11b470><li data-v-3d11b470><a href="#many-to-one-one-to-many-relationships" data-v-3d11b470>many-to-one / one-to-many relationships</a><ul data-v-3d11b470><li data-v-3d11b470><a href="#saving-many-to-one-one-to-many-relationships" data-v-3d11b470>Saving many-to-one / one-to-many relationships</a></li><li data-v-3d11b470><a href="#loading-many-to-one-one-to-many-related-records" data-v-3d11b470>Loading many-to-one / one-to-many related records</a></li><li data-v-3d11b470><a href="#removing-a-many-to-one-one-to-many-relationship" data-v-3d11b470>Removing a many-to-one / one-to-many relationship</a></li></ul></li><li data-v-3d11b470><a href="#many-to-many-relationship" data-v-3d11b470>many-to-many relationship</a><ul data-v-3d11b470><li data-v-3d11b470><a href="#uni-directional-many-to-many-relationship" data-v-3d11b470>uni-directional many-to-many relationship</a></li><li data-v-3d11b470><a href="#bi-directional-many-to-many-relationship" data-v-3d11b470>bi-directional many-to-many relationship</a></li><li data-v-3d11b470><a href="#saving-many-to-many-relationship" data-v-3d11b470>Saving many-to-many relationship</a></li><li data-v-3d11b470><a href="#loading-many-to-many-relationship" data-v-3d11b470>Loading many-to-many relationship</a></li><li data-v-3d11b470><a href="#many-to-many-relationship-and-custom-properties" data-v-3d11b470>many-to-many relationship and custom properties</a></li></ul></li><li data-v-3d11b470><a href="#one-to-one-relationship" data-v-3d11b470>one-to-one relationship</a></li></ul></li><li data-v-3d11b470><a href="#next-steps" data-v-3d11b470>Next steps</a></li></ul></div></div></div><p></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>ZenTS provides you with all the tools you need to work with databases in your application. ZenTS uses <a href="https://typeorm.io" target="_blank" rel="noopener noreferrer">TypeORM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for its Object-Relational Mapping, which is a ORM directly written for TypeScript projects. TypeORM supports a wide range of relational databases like <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">PostgreSQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, but also offers (experimental) support for <a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">MongoDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. When working with database tables you'll work with entities (sometimes also called models), which are part of the MVC architecture. Databases are a broad topic, although this guide will cover the most features of TypeORM, you should also take a look at the <a href="https://typeorm.io" target="_blank" rel="noopener noreferrer">official documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="installing-a-driver"><a href="#installing-a-driver" class="header-anchor">#</a> Installing a driver</h2> <p>Before you start connecting your application to a database, you need to install a database driver. Open up a console and head to the project application root folder. Then install <strong>one</strong> of the following drivers, depending on which database you like to us:</p> <ul><li><a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://mariadb.org/" target="_blank" rel="noopener noreferrer">MariaDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>npm install mysql --save</code> or <code>npm install mysql2 --save</code></li> <li><a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">PostgreSQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://github.com/cockroachdb/cockroach" target="_blank" rel="noopener noreferrer">CockroachDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>npm install pg --save</code></li> <li><a href="https://sqlite.org/index.html" target="_blank" rel="noopener noreferrer">SQLite<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>npm install sqlite3 --save</code></li> <li><a href="https://www.microsoft.com/en-us/sql-server/sql-server-2019" target="_blank" rel="noopener noreferrer">MSSQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>npm install mssql --save</code></li> <li><a href="https://github.com/sql-js/sql.js" target="_blank" rel="noopener noreferrer">SQL.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>npm install sql.js --save</code></li> <li><a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">MongoDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>npm install mongodb --save</code></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>TypeORM is installed by default when using ZenTS's CLI. If you manually installed ZenTS, you can install TypeORM by running <code>npm install typeorm --save</code> in your projects root folder.</p></div> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>Although TypeORM supports databases like Oracle and SAP Hana, they aren't supported by ZenTS. The same counts for NativeScript, react-native and Cordova drivers, because ZenTS is a backend framework and not suitable to run in these environments.</p></div> <h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <p>After you've installed the correct driver, it's time to configure your database. Open your config file and add a <code>database</code> property including an <code>enable</code> flag. Other properties depend on the driver you've installed, but most of them will force you to configure <code>type</code>, <code>host</code>, <code>password</code>, <code>database</code> and a <code>port</code>. Please see the <a href="/configuration.html">configuration guide</a> for more information about different configuration scenarios depending on the installed database driver.</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;database&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;enable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;postgres&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">5432</span><span class="token punctuation">,</span>
    <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zen&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;secret&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;database&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zen&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  database<span class="token operator">:</span> <span class="token punctuation">{</span>
    enable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">'postgres'</span><span class="token punctuation">,</span>
    host<span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
    port<span class="token operator">:</span> <span class="token number">5432</span><span class="token punctuation">,</span>
    username<span class="token operator">:</span> <span class="token string">'zen'</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">'secret'</span><span class="token punctuation">,</span>
    database<span class="token operator">:</span> <span class="token string">'zen'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">database</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> postgres
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5432</span>
  <span class="token punctuation">-</span> <span class="token key atrule">username</span><span class="token punctuation">:</span> zen
  <span class="token punctuation">-</span> <span class="token key atrule">password</span><span class="token punctuation">:</span> secret
  <span class="token punctuation">-</span> <span class="token key atrule">database</span><span class="token punctuation">:</span> zen
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div></div></div> <p>The <code>type</code> option depends on the database driver you've chosen:</p> <ul><li>for <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>mysql</code></li> <li>for <a href="https://mariadb.org/" target="_blank" rel="noopener noreferrer">MariaDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>mariadb</code></li> <li>for <a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">PostgreSQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>postgres</code></li> <li>for <a href="https://github.com/cockroachdb/cockroach" target="_blank" rel="noopener noreferrer">CockroachDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>cockroachdb</code></li> <li>for <a href="https://sqlite.org/index.html" target="_blank" rel="noopener noreferrer">SQLite<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>sqlite</code></li> <li>for <a href="https://www.microsoft.com/en-us/sql-server/sql-server-2019" target="_blank" rel="noopener noreferrer">MSSQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>mssql</code></li> <li>for <a href="https://github.com/sql-js/sql.js" target="_blank" rel="noopener noreferrer">SQL.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>sqljs</code></li> <li>for <a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">MongoDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: <code>mongodb</code></li></ul> <p>It is also good to remember, that you can specify different connection options in environment specific configuration files. Head over to the <a href="/configuration.html">configuration guide</a> to learn how to do that.</p> <p>Database support can also be disabled if your application doesn't need it. Just set the <code>config.database.enable</code> configuration option to <code>false</code> (which is the default value). Database support is then disabled.</p> <h2 id="creating-entities"><a href="#creating-entities" class="header-anchor">#</a> Creating entities</h2> <p>Models in ZenTS are called <strong>entities</strong>. Entities are saved in the <code>src/entity</code> directory of your application (the folder is <a href="/configuration.html">configurable</a>). You can name your entities like you wish, but since entities are ECMAScript classes you might want to name them like the class your are using, e.g. a <code>Product</code> entity is saved in <code>Product.ts</code>. An entity always represents a table in your database, so make sure to create a <code>product</code> table after you've created the following example entity:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/Product.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>A entity can also be created using the CLI. Use the <code>zen add:entity Product</code> command to create a entity. Read the <a href="/cli.html">CLI guide</a> to learn more about this and other commands.</p></div> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Entities can't be put in a sub-folders.</p></div> <p>Similar to route definitions, entities are using annotations (e.g. <code>@Column()</code>) to tell the ORM how to map specific table columns to the corresponding class members. Every entity needs an <code>@Entity()</code> annotation above its class definition.</p> <h3 id="specifying-column-types"><a href="#specifying-column-types" class="header-anchor">#</a> Specifying column types</h3> <p>To specify a column, we use the <code>@Column()</code> annotation, which has a optional argument as first argument.</p> <p>When you pass a string as first argument to the <code>@Column()</code> annotation, it will be used to define the type of the column. For example, if our <code>price</code> column is from type <code>decimal</code>, we need to change the declaration this way:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'decimal'</span><span class="token punctuation">)</span>
price<span class="token operator">:</span> <span class="token builtin">number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Which types are supported depends on the database you're using. The supported types for each database can be found <a href="https://github.com/typeorm/typeorm/blob/master/docs/entities.md#column-types" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <p>Column types can also be specified by using an object as first argument with a <code>type</code> property:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'decimal'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
price<span class="token operator">:</span> <span class="token builtin">number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="column-options"><a href="#column-options" class="header-anchor">#</a> Column options</h3> <p>Depending on its type and the used database, the <code>@Column()</code> decorator can take multiple entity column based option parameters.</p> <p>The options are either defined by using an object as first argument:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'decimal'</span><span class="token punctuation">,</span>
    <span class="token comment">// ... more options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
price<span class="token operator">:</span> <span class="token builtin">number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>or by using an optional second argument while defining the type as string as first argument:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'decimal'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... column specific options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
price<span class="token operator">:</span> <span class="token builtin">number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The available options are:</p> <ul><li><code>type</code> (string): The column type (see above).</li> <li><code>name</code> (string): The name of the column in the table. By default the column name is generated from the name of the property (e.g. <code>price</code>). If you like to use a different property key, you have to set the correct table column name with this option.</li> <li><code>length</code> (number): The length of a column (e.g. <code>varchar(150)</code>).</li> <li><code>width</code> (number): Column type's display width (used only for <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> integer types).</li> <li><code>onUpdate</code> (string): <code>ON UPDATE</code> trigger for <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li><code>nullable</code> (boolean, default: <code>false</code>): Indicates if a column is nullable (<code>NULL</code> or <code>NOT NULL</code>).</li> <li><code>update</code> (boolean, default: <code>true</code>): Indicates if column value is updated by update operation. If you set this value to <code>false</code>, the column will only be set when a record is created.</li> <li><code>insert</code> (boolean, default: <code>true</code>): Indicates that a column is set when a record is created. If you set this value to <code>false</code>, the column won't be set when the record is created.</li> <li><code>select</code> (boolean, default: <code>true</code>): Indicates if this column is returned by default when making queries. Set this option to <code>false</code> and the column must be explicit specified in <code>SELECT</code> queries, otherwise the column will be omitted.</li> <li><code>default</code> (any): The default value of the column.</li> <li><code>primary</code> (boolean): Indicates that the column is a primary key.</li> <li><code>unique</code> (boolean): Set the column as unique.</li> <li><code>comment</code> (string): Database level column comment.</li> <li><code>precision</code> (number): The precision for a decimal column type.</li> <li><code>scale</code> (number): The scale for a decimal column type.</li> <li><code>zerofill</code> (boolean): Puts <code>ZEROFILL</code> attribute on to a numeric column (only supported by <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</li> <li><code>unsigned</code> (boolean): Marks the column as <code>UNSIGNED</code>.</li> <li><code>charset</code> (string): Defines a column character set.</li> <li><code>collation</code> (string): Defines a column collation.</li> <li><code>enum</code> (string[]|Enums): Define a column's enum values. See below for more information on how to define enums.</li> <li><code>asExpression</code> (string): Generated column expression (only supported by <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</li> <li><code>generatedType</code> (string): Generated column type (only supported by <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</li></ul> <h3 id="primary-key-column"><a href="#primary-key-column" class="header-anchor">#</a> Primary key column</h3> <p>A primary key column is declared with the <code>@PrimaryColumn()</code> annotation:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  <span class="token comment">// ... other columns</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>In TypeORM every entity <strong><em>needs</em></strong> at least <strong><em>one</em></strong> primary column. This is a requirement and can't be avoided. You can use either <code>@PrimaryColumn()</code> or <code>@PrimaryGeneratedColumn()</code> annotation to declare your primary key column.</p></div> <h3 id="auto-increment-serial-column"><a href="#auto-increment-serial-column" class="header-anchor">#</a> Auto increment / serial column</h3> <p>Auto generated columns (also know as auto-increment / sequence / serial / generated identity column) are declared by using the <code>@PrimaryGeneratedColumn()</code> decorator:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  <span class="token comment">// ... other columns</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>This decorator / column type is usually used to for ID columns, which are integers that increment their number automatically when a new record is inserted (see <a href="https://dev.mysql.com/doc/refman/8.0/en/example-auto-increment.html" target="_blank" rel="noopener noreferrer">MySQL documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://www.tutorialspoint.com/postgresql/postgresql_using_autoincrement.htm" target="_blank" rel="noopener noreferrer">PostgreSQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, please see the documentation from the database of your choice for other examples).</p> <h3 id="declaring-enum-column-type"><a href="#declaring-enum-column-type" class="header-anchor">#</a> Declaring enum column type</h3> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p><code>enum</code> column types are only supported by <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">PostgreSQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>!</p></div> <p><code>enum</code> types are declared by creating a corresponding <a href="https://www.typescriptlang.org/docs/handbook/enums.html" target="_blank" rel="noopener noreferrer">TypeScript enum<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or by using an array with predefined values:</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">enum</span> <span class="token constant">TAGS</span> <span class="token punctuation">{</span>
  <span class="token constant">NEW</span> <span class="token operator">=</span> <span class="token string">'new'</span><span class="token punctuation">,</span>
  <span class="token constant">SALE</span> <span class="token operator">=</span> <span class="token string">'sale'</span><span class="token punctuation">,</span>
  <span class="token constant">RESELL</span> <span class="token operator">=</span> <span class="token string">'resell'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'enum'</span><span class="token punctuation">,</span>
    <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token constant">TAGS</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token constant">TAGS</span><span class="token punctuation">.</span><span class="token constant">NEW</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  tag<span class="token operator">:</span> <span class="token constant">TAGS</span>

  <span class="token comment">// ... other columns</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">type</span> <span class="token class-name">tags</span> <span class="token operator">=</span> <span class="token string">'new'</span> <span class="token operator">|</span> <span class="token string">'sale'</span> <span class="token operator">|</span> <span class="token string">'resell'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'enum'</span><span class="token punctuation">,</span>
    <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'new'</span><span class="token punctuation">,</span> <span class="token string">'sale'</span><span class="token punctuation">,</span> <span class="token string">'resell'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'new'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  tag<span class="token operator">:</span> tags

  <span class="token comment">// ... other columns</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></div></div></div> <h3 id="declaring-set-column-types"><a href="#declaring-set-column-types" class="header-anchor">#</a> Declaring set column types</h3> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p><code>set</code> column types are only supported by <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>!</p></div> <p>Declaring <code>set</code> column types is similar to declaring <code>enum</code> column types by either creating a corresponding <a href="https://www.typescriptlang.org/docs/handbook/enums.html" target="_blank" rel="noopener noreferrer">TypeScript enum<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or an array with predefined values:</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">enum</span> <span class="token constant">TAGS</span> <span class="token punctuation">{</span>
  <span class="token constant">NEW</span> <span class="token operator">=</span> <span class="token string">'new'</span><span class="token punctuation">,</span>
  <span class="token constant">SALE</span> <span class="token operator">=</span> <span class="token string">'sale'</span><span class="token punctuation">,</span>
  <span class="token constant">RESELL</span> <span class="token operator">=</span> <span class="token string">'resell'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'set'</span><span class="token punctuation">,</span>
    <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token constant">TAGS</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">TAGS</span><span class="token punctuation">.</span><span class="token constant">NEW</span><span class="token punctuation">,</span> <span class="token constant">TAGS</span><span class="token punctuation">.</span><span class="token constant">SALE</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  tag<span class="token operator">:</span> <span class="token constant">TAGS</span><span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token comment">// ... other columns</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">type</span> <span class="token class-name">tags</span> <span class="token operator">=</span> <span class="token string">'new'</span> <span class="token operator">|</span> <span class="token string">'sale'</span> <span class="token operator">|</span> <span class="token string">'resell'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'set'</span><span class="token punctuation">,</span>
    <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'new'</span><span class="token punctuation">,</span> <span class="token string">'sale'</span><span class="token punctuation">,</span> <span class="token string">'resell'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'new'</span><span class="token punctuation">,</span> <span class="token string">'sale'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  tag<span class="token operator">:</span> tags<span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token comment">// ... other columns</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></div></div></div> <h3 id="special-column-types-simple-array-simple-json"><a href="#special-column-types-simple-array-simple-json" class="header-anchor">#</a> Special column types (simple-array &amp; simple-json)</h3> <p>TypeORM offers two special column types: <strong>simple-array</strong> and <strong>simple-json</strong>. Use them with caution, because they are computed by your application and not by the database server. When your database supports JSON-columns (like <a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">PostgreSQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) then you better use the build in types.</p> <h4 id="simple-array"><a href="#simple-array" class="header-anchor">#</a> simple-array</h4> <p>Stores primitive arrays (e.g. <code>string[]</code>, <code>number[]</code>, ...) in a string column type. All values will be separated by commas, so you can't use commas in your values.</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'simple-array'</span><span class="token punctuation">)</span>
names<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="simple-json"><a href="#simple-json" class="header-anchor">#</a> simple-json</h4> <p>Stores a JSON into a string column type. The JSON must be serialize-able via <code>JSON.stringify()</code>. When the column is returned in a record the string will be deserialized by <code>JSON.parse()</code>.</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'simple-json'</span><span class="token punctuation">)</span>
profile<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="auto-generated-values"><a href="#auto-generated-values" class="header-anchor">#</a> Auto generated values</h3> <p>TypeORM has some value generators build in, which you can attach to a column with the <code>@Generated</code> annotation.</p> <h4 id="uuid"><a href="#uuid" class="header-anchor">#</a> UUID</h4> <p>Generates a UUID as value for a column automatically:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> Generated <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  @<span class="token function">Generated</span><span class="token punctuation">(</span><span class="token string">'uuid'</span><span class="token punctuation">)</span>
  uuid<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="increment"><a href="#increment" class="header-anchor">#</a> Increment</h4> <p>Increment a number-like (e.g. <code>int</code>) column by one:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> Generated <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  @<span class="token function">Generated</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span>
  counter<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>From the TypeORM documentation: &quot;<em>There are some limitations on some database platforms with this type of generation (for example some databases can only have one increment column, or some of them require increment to be a primary key).</em>&quot;</p> <p>Please refer to your database documentation for more information.</p></div> <h2 id="accessing-orm-in-a-controller-or-service"><a href="#accessing-orm-in-a-controller-or-service" class="header-anchor">#</a> Accessing ORM in a controller or service</h2> <p>Before we move on and learn how we work with entities, it's important to know how you can access the ORM related functions inside a controller or service. This is done with the help of dependency injection.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Dependency injection in ZenTS are covered in <a href="/guide/advancedguides/dependency_injection.html">this guide</a>.</p></div> <h3 id="injecting-the-connection"><a href="#injecting-the-connection" class="header-anchor">#</a> Injecting the connection</h3> <p>TypeORM exposes a connection to the user with which records can be queried and saved. In a ZenTS application, the connection is automatically created for you. To inject the connection in a controller (or service) use the <code>@connection</code> annotation:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> connection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zents'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Connection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token keyword">extends</span></span> Controller <span class="token punctuation">{</span>
  @connection
  <span class="token keyword">private</span> con<span class="token operator">:</span> Connection

  <span class="token comment">// ... controller implementation</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>The connection is now available under the <code>this.con</code> property:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> context<span class="token punctuation">,</span> Context<span class="token punctuation">,</span> connection<span class="token punctuation">,</span> <span class="token keyword">get</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zents'</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> Connection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token keyword">extends</span></span> Controller <span class="token punctuation">{</span>
  @connection
  <span class="token keyword">private</span> con<span class="token operator">:</span> Connection

  @<span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span>@context ctx<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something with this.con</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Note the difference in casing between the <code>Connection</code> interface exported by <code>typeorm</code> and the <code>@connection</code> annotation exported by <code>zents</code>. Annotations in ZenTS are always written in lower camel-case.</p></div> <h3 id="injecting-the-entity-manager"><a href="#injecting-the-entity-manager" class="header-anchor">#</a> Injecting the Entity Manager</h3> <p>TypeORM's <em>EntityManager</em> can be injected into a controller or service quiet similar, by using the <code>@entityManager</code> annotation. The <em>EntityManager</em> allows quick access to methods like <code>save()</code> or <code>find()</code>, which can be used to interact with records from a database. Its the recommend way to use the <em>EntityManager</em> instead of the more low-level connection.</p> <p>An example of an injected <em>EntityManager</em> looks like this:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> context<span class="token punctuation">,</span> Context<span class="token punctuation">,</span> entityManager<span class="token punctuation">,</span> <span class="token keyword">get</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zents'</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EntityManager <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token keyword">extends</span></span> Controller <span class="token punctuation">{</span>
  @entityManager
  <span class="token keyword">private</span> em<span class="token operator">:</span> EntityManager

  @<span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span>@context ctx<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something with this.em</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="persisting-records-to-the-database"><a href="#persisting-records-to-the-database" class="header-anchor">#</a> Persisting records to the database</h2> <p>Now that you're familiar with creating entities and injecting the EntityManager/connection from TypeORM into a controller, lets start by persisting a record to the database. First we need to import our <code>Product</code> entity we created earlier. Then we assign the values to the instance of our entity and last but not least, we will save it to the database by calling <code>save()</code> on the <em>EntityManager</em> we injected earlier:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> entityManager<span class="token punctuation">,</span> post<span class="token punctuation">,</span> log <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zents'</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EntityManager <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Product <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../entity/Product'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token keyword">extends</span></span> Controller <span class="token punctuation">{</span>
  @entityManager
  <span class="token keyword">private</span> em<span class="token operator">:</span> EntityManager

  @<span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/product'</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">createProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    product<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'My Product'</span>
    product<span class="token punctuation">.</span>price <span class="token operator">=</span> <span class="token number">4200</span>

    product <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>em<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span>
    log<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Product has been saved! Product id is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>product<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>This process is pretty straightforward:</p> <ul><li><em>line 4</em>: Import the <code>Product</code> entity we created earlier.</li> <li><em>line 7-8</em>: Injecting the <em>EntityManager</em> in our controller. The manager will be available under the <code>this.em</code> property.</li> <li><em>line 10</em>: Declare a new <code>/product</code> POST route.</li> <li><em>line 12</em>: Create a new instance of our <code>Product</code> entity.</li> <li><em>line 14-15</em>: Set values for the <code>name</code> and <code>price</code> column. They could also be coming from a request body (e.g. <code>product.name = body.name</code>).</li> <li><em>line 17</em>: Persist the <code>Product</code> instance to the database. The record is created automatically and the <code>product</code> instance will have a newly populated <code>id</code> property attached.</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you're using the <code>connection</code> from TypeORM, the <em>EntityManager</em> is accessible under the <code>connection.manager</code> property (e.g. <code>connection.manager.save()</code>).</p></div> <p>Since we are using <code>async / await</code> syntax here, errors from the database will crash the server (at worst). If you want to prevent that, you've to encapsule the <code>save()</code> call into a <code>try / catch</code> block:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">createProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    product <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>em<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something with error</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="fetching-records-from-the-database-with-repositories"><a href="#fetching-records-from-the-database-with-repositories" class="header-anchor">#</a> Fetching records from the database with repositories</h2> <p>Receiving records from the database is done by so-called repositories. A repository is similar to the <em>EntityManager</em>, e.g. it has a <code>save()</code> and <code>find()</code> method attached to it, but its operations are limited to one specific entity.</p> <p>ZenTS offers you three ways to access a repository (or multiple repositories) in a <a href="/guide/advancedguides/controllers.html">controller</a> action or <a href="./services">service</a>:</p> <h4 id="injecting-the-repository-into-a-method-recommend"><a href="#injecting-the-repository-into-a-method-recommend" class="header-anchor">#</a> Injecting the repository into a method (recommend)</h4> <p>Repositories can be injected into a controller / service method by using the <code>@repository()</code> annotation, which requires one argument (the entity). This is the recommended way to use a repository, because it allows your application to be written in the <a href="https://en.wikipedia.org/wiki/Single-responsibility_principle" target="_blank" rel="noopener noreferrer">SOLID principle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> entityManager<span class="token punctuation">,</span> <span class="token keyword">get</span><span class="token punctuation">,</span> log<span class="token punctuation">,</span> repository <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zents'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Repository <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Product <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../entity/Product'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token keyword">extends</span></span> Controller <span class="token punctuation">{</span>
  @<span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/product/:productId'</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">detailProduct</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token operator">:</span> Repository<span class="token operator">&lt;</span>Product<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// use productRepo.find() etc. here</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="using-the-entitymanager-connection"><a href="#using-the-entitymanager-connection" class="header-anchor">#</a> Using the EntityManager / connection</h4> <p>You can also use the <em>EntityManager</em> or connection to grab a repository:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> con<span class="token punctuation">,</span> entityManager<span class="token punctuation">,</span> post<span class="token punctuation">,</span> log <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zents'</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> Connection<span class="token punctuation">,</span> EntityManager <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Product <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../entity/Product'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token keyword">extends</span></span> Controller <span class="token punctuation">{</span>
  @entityManager
  <span class="token keyword">private</span> em<span class="token operator">:</span> EntityManager

  @connection
  <span class="token keyword">private</span> con<span class="token operator">:</span> Connection

  @<span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/product/:productId'</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">detailProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> productRepo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>em<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span>
    <span class="token comment">// or</span>
    <span class="token comment">// const productRepo = this.con.getRepository(Product)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>Note</strong>: it isn't a good idea to have both the <em>EntityManager</em> and connection to the controller, as this is some kind of unnecessarily redundance. If you need both, just inject the connection and access the <em>EntityManager</em> with <code>this.con.manager</code>.</p> <p>Now you should know the basics of repositories, but there is more to them, which we'll talk about later in this guide. For now let us use the injected repository to fetch some records from the database:</p> <h3 id="find-all-records"><a href="#find-all-records" class="header-anchor">#</a> Find all records</h3> <p>To fetch all records in a table, call <code>find()</code> without an argument:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="find-specific-records"><a href="#find-specific-records" class="header-anchor">#</a> Find specific records</h3> <p>To query for specific records (<code>WHERE ... AND ...</code>), you can supply an object as first argument to the <code>find()</code> method:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    price<span class="token operator">:</span> <span class="token number">4900</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="find-one-record"><a href="#find-one-record" class="header-anchor">#</a> Find one record</h3> <p>To limit the result to one record use the <code>findOne()</code> repository method:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'My Product'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="find-record-s-by-id"><a href="#find-record-s-by-id" class="header-anchor">#</a> Find record(s) by id</h3> <p>To fetch one or multiple record(s) from a table by ID use the <code>findByIds()</code> repository method:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">findByIds</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="find-and-count"><a href="#find-and-count" class="header-anchor">#</a> Find and count</h3> <p>To receive a set of records and count the possible returned records (without pagination), use the <code>findAndCount()</code> repository method:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>products<span class="token punctuation">,</span> productsCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">findAndCount</span><span class="token punctuation">(</span><span class="token comment">/* optional: {} */</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="find-methods-options-and-conditions"><a href="#find-methods-options-and-conditions" class="header-anchor">#</a> Find methods options and conditions</h3> <p>All the above methods supports a wide range of option and conditions (e.g. <code>WHERE ... OR ...</code> queries). It's highly recommend to take a look at the <a href="https://github.com/typeorm/typeorm/blob/master/docs/find-options.md" target="_blank" rel="noopener noreferrer">official documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to learn more about them, as they are one of the keys to master TypeORM.</p> <h2 id="updating-a-record"><a href="#updating-a-record" class="header-anchor">#</a> Updating a record</h2> <p>In order to update a record in a table, you first need to fetch it from the database using a repository. After that, you just modify the instance member values and save it back using the same repository:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'My Product'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  product<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'My awesome updated Product'</span>

  <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="deleting-a-record"><a href="#deleting-a-record" class="header-anchor">#</a> Deleting a record</h2> <p>Removing a record from a table is simple, just call the <code>remove()</code> method of a repository and the record will be deleted:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'My Product'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span>

  <span class="token keyword">const</span> oldProduct <span class="token operator">=</span> <span class="token keyword">await</span> productRepo<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'My Product'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>oldProduct<span class="token punctuation">)</span> <span class="token comment">// logs null</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="working-with-relationships"><a href="#working-with-relationships" class="header-anchor">#</a> Working with relationships</h2> <p>In <a href="https://en.wikipedia.org/wiki/Relational_database" target="_blank" rel="noopener noreferrer">RDBMS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> relationships (sometimes also called associations) play an important role in connecting one or more records with each other. TypeORM supports all important relationships, including <code>many-to-one</code>, <code>one-to-many</code>, <code>one-to-one</code> and <code>many-to-many</code>.</p> <p>They can be divided into two different relationship types:</p> <ul><li><p><code>many-to-one</code> / <code>one-to-many</code> / <code>one-to-one</code>: This is probably the most used type of relationship, they map a column with a foreign key to a column of a different table (e.g. a <code>categoryId</code> column on a <code>Product</code> entity). Technically <code>many-to-one</code> and <code>one-to-many</code> are the same relationship, but seen from two different sides of the relation between two records. A <code>one-to-one</code> relationship is quiet similar, but they only allowing a exclusive one-to-one mapping. For example an <code>User</code> entity has exactly one relationship with ab <code>Profile</code> entity and that <code>Profile</code> can't have a relationship with a different <code>User</code> entity, while on a <code>many-to-one</code> (or <code>one-to-many</code>) relationship, a <code>Category</code> can be assigned to multiple <code>Products</code>.</p></li> <li><p><code>many-to-many</code>: This is the less common but nevertheless not unimportant type of a relationship between records using a so-called join table. This relationship is necessary when both sides of the relationship can have many of the other side (e.g. a <code>ShoppingMall</code> and <code>Store</code> entity relationship, where each shopping mall can have many stores and each store can be in many different shopping malls). The relationship is then stored in a join table with a <code>shoppingmallId</code> and <code>storeId</code> foreign key columns, which connects both records with each other.</p></li></ul> <h3 id="many-to-one-one-to-many-relationships"><a href="#many-to-one-one-to-many-relationships" class="header-anchor">#</a> many-to-one / one-to-many relationships</h3> <p>Lets start with the most common relationship <code>many-to-one</code> and its little brother <code>one-to-many</code>. Going back to our <code>Product</code> example from before, we want to relate a product record to a <code>Category</code>, in a way that a product belongs to exactly one category.</p> <p>First we need to create a <code>Category</code> entity:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/Category.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>For simplicity we just assign a <code>id</code> and <code>name</code> column to this table. In this example, each category can be connected with <em>many</em> products. On the other side, each product can only be assigned to <em>one</em> category. To summarize this, the <code>Product</code> entity has a <code>many-to-one</code> relationship with the <code>Category</code> entity. From the perspective of the <code>Category</code> entity it's a <code>one-to-many</code> relationship.</p> <p>How we map this? Lets start by editing our <code>Product</code> entity created earlier in this guide and use the <code>@ManyToOne</code> annotation from TypeORM to start the mapping on the <code>Product</code> entity:</p> <div class="language-typescript line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"></div><div class="highlighted"></div><br><br></div><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> ManyToOne<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Category <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Category'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">ManyToOne</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Category<span class="token punctuation">,</span> <span class="token punctuation">(</span>category<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> category<span class="token punctuation">.</span>products<span class="token punctuation">)</span>
  category<span class="token operator">:</span> Category
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>The above source code can be described like this:</p> <ul><li><em>line 2</em>: Import the <code>Category</code> entity we just created.</li> <li><em>line 14-15</em>: Use the <code>@ManyToOne</code> annotation to create a relationship between many products and one category. The first argument have to return an entity (<code>Category</code>).</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>By default TypeORM assumes the foreign key column is in the schema <code>entityId</code> (e.g the category value will be stored in a <code>categoryId</code> column). If you wish to use a different join column, TypeORM exposes a <code>@JoinColumn</code> annotation, with which you can define the column name (e.g. <code>@JoinColumn({ name: 'category_id' })</code>). Read more about the <code>@JoinColumn</code> annotation in the <a href="https://github.com/typeorm/typeorm/blob/master/docs/relations.md#joincolumn-options" target="_blank" rel="noopener noreferrer">official documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <p>The <code>many-to-one</code> mapping is required when using this kind of relationship type. On the other hand, the <code>one-to-many</code> mapping is totally optional and can be omitted when you only care about the <code>many-to-one</code> relationship.</p> <p>Nevertheless a <code>one-to-many</code> relationship is created similar to <code>many-to-one</code>. We just need to add the <code>@OneToMany</code> annotation on the entity class member we wish to populate:</p> <div class="language-typescript line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"></div><div class="highlighted"></div><br><br></div><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> OneToMany<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Product <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Product'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">OneToMany</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Product<span class="token punctuation">,</span> <span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> product<span class="token punctuation">.</span>category<span class="token punctuation">)</span>
  products<span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>This time we added the <code>products</code> property to our <code>Category</code> entity. Now all products associated with a given category can be easily queried (and saved).</p> <h4 id="saving-many-to-one-one-to-many-relationships"><a href="#saving-many-to-one-one-to-many-relationships" class="header-anchor">#</a> Saving many-to-one / one-to-many relationships</h4> <p>Saving a relationship is as easy as assigning the relationship value to the right member of an entity:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> con<span class="token punctuation">,</span> entityManager<span class="token punctuation">,</span> post<span class="token punctuation">,</span> log <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zents'</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EntityManager <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Product <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../entity/Product'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Category <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../entity/Category'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token keyword">extends</span></span> Controller <span class="token punctuation">{</span>
  @entityManager
  <span class="token keyword">private</span> em<span class="token operator">:</span> EntityManager

  @<span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/category'</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">createCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> category <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Category</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    category<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'My Category'</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>em<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>category<span class="token punctuation">)</span>

    <span class="token keyword">const</span> product1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    product1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'My Product 1'</span>
    product1<span class="token punctuation">.</span>category <span class="token operator">=</span> category
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>em<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product1<span class="token punctuation">)</span>

    <span class="token keyword">const</span> product2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    product2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'My Product 2'</span>
    product2<span class="token punctuation">.</span>category <span class="token operator">=</span> category
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>em<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product2<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h4 id="loading-many-to-one-one-to-many-related-records"><a href="#loading-many-to-one-one-to-many-related-records" class="header-anchor">#</a> Loading many-to-one / one-to-many related records</h4> <p>To load related records (e.g. products) when you fetch a category, you've to specify the relationship via a <code>relations</code> property inside the <code>find()</code> options argument:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Category<span class="token punctuation">)</span> categoryRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> category <span class="token operator">=</span> <span class="token keyword">await</span> categoryRepo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'products'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>category<span class="token punctuation">.</span>products<span class="token punctuation">)</span> <span class="token comment">// will log an array of products associated with the category</span>
<span class="token punctuation">}</span>

<span class="token comment">// or</span>

<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token keyword">await</span> product<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'My Product 1'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'category'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>product<span class="token punctuation">.</span>category<span class="token punctuation">)</span> <span class="token comment">// will log the category associated with the product</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>If you wish to <strong>always</strong> load relationships automatically you can enable eager loading for a relationship:</p> <div class="language-typescript line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"></div><br><br><br><br></div><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> ManyToOne<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Category <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Category'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">ManyToOne</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Category<span class="token punctuation">,</span> <span class="token punctuation">(</span>category<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> product<span class="token punctuation">.</span>category<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    eager<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  category<span class="token operator">:</span> Category
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>This way the <code>category</code> property will be always populated when fetching a <code>product</code> record from the database. Keep in mind that this can be really expensive, because all records have to be fetched from the database first. You should only use eager loading only when its reasonable for your scenario.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>There are even more options (like cascades, primary relationship columns, nullable, etc.) related to relationships. Please consider looking at the official documentation <a href="https://github.com/typeorm/typeorm/blob/master/docs/relations.md" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and/or <a href="https://github.com/typeorm/typeorm/blob/master/docs/many-to-one-one-to-many-relations.md" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <h4 id="removing-a-many-to-one-one-to-many-relationship"><a href="#removing-a-many-to-one-one-to-many-relationship" class="header-anchor">#</a> Removing a many-to-one / one-to-many relationship</h4> <p>You can remove a existing relationship by setting its mapping value to <code>null</code> (if the column is nullable):</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span> @<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token keyword">await</span> product<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'My Product 1'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  product<span class="token punctuation">.</span>category <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>em<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="many-to-many-relationship"><a href="#many-to-many-relationship" class="header-anchor">#</a> many-to-many relationship</h3> <p>A <code>many-to-many</code> relationship is different from <code>many-to-one</code> / <code>one-to-many</code> relationships because they say, that many things of <em>A</em> are related to many things of <em>B</em> and many things of <em>B</em> are related to many things of <em>B</em>. For example, lets change the requirements of our previous example and say the following:</p> <p><em>Many</em> <code>Products</code> can be in <em>many</em> <code>Categories</code>. This is called a <code>many-to-many</code> relationship. In relational databases this kind of association is created by using a so-called join table, which usually only holds the IDs of the related entities (e.g. <code>productId</code> and <code>categoryId</code>). This kind of relationship can be either uni-directional or bi-directional.</p> <h4 id="uni-directional-many-to-many-relationship"><a href="#uni-directional-many-to-many-relationship" class="header-anchor">#</a> uni-directional many-to-many relationship</h4> <p>First we create a uni-directional <code>many-to-many</code> relationship between our <code>Product</code> and <code>Category</code> entities:</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"></div><div class="highlighted"></div><div class="highlighted"></div><br><br></div><pre class="language-typescript"><code><span class="token comment">// src/entity/Product.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> ManyToOne<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> JoinTable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Category <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Category'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">ManyToMany</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Category<span class="token punctuation">)</span>
  @<span class="token function">JoinTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  categories<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/Category.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></div></div></div> <p>As you probably guessed, <code>many-to-many</code> relationships are mapped by using the <code>@ManyToMany</code> annotation from TypeORM. In addition the <code>@JoinTable()</code> annotation is required in <code>many-to-many</code> relationship mappings, because it tells TypeORM which of the side is the <em>owning side</em> of the relation. But did you notice that there is basically no special mapping happen in the <code>Category</code> entity? That is because this <code>many-to-many</code> mapping is uni-directional, meaning the categories have no idea which products are associated with them (at least from a ORM point of view).</p> <h4 id="bi-directional-many-to-many-relationship"><a href="#bi-directional-many-to-many-relationship" class="header-anchor">#</a> bi-directional many-to-many relationship</h4> <p>In our previous example we created a uni-directional mapping between <em>many</em> products and <em>many</em> categories. The problem with that is, that the ORM doesn't know which products are associated with a specific category (only by doing manual queries). The solution to this problem is to use a bi-directional <code>many-to-many</code> relationship. This way, both sides of the association knows about each other and how to fetch the related records:</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/Product.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> ManyToMany<span class="token punctuation">,</span> JoinTable<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Category <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Category'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">ManyToMany</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Category<span class="token punctuation">,</span> <span class="token punctuation">(</span>category<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> category<span class="token punctuation">.</span>products<span class="token punctuation">)</span>
  @<span class="token function">JoinTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  categories<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/Category.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> ManyToMany <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Product <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Product'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">ManyToMany</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Product<span class="token punctuation">,</span> <span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> product<span class="token punctuation">.</span>categories<span class="token punctuation">)</span>
  products<span class="token operator">:</span> Product<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div></div></div> <p>Now both side knows about the related records. Please note that the <code>@JoinTable</code> annotation isn't bind to the inverse relation side, because it must be only on one side.</p> <h4 id="saving-many-to-many-relationship"><a href="#saving-many-to-many-relationship" class="header-anchor">#</a> Saving many-to-many relationship</h4> <p>In order to save such a <code>many-to-many</code> relationship, we just use the usual <code>save()</code> method and assign (multiple) record(s) to the mapped relation property:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> con<span class="token punctuation">,</span> entityManager<span class="token punctuation">,</span> post<span class="token punctuation">,</span> log <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zents'</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EntityManager <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Product <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../entity/Product'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Category <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../entity/Category'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token keyword">extends</span></span> Controller <span class="token punctuation">{</span>
  @entityManager
  <span class="token keyword">private</span> em<span class="token operator">:</span> EntityManager

  @<span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/product'</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">createProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> category1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Category</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    category1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'My Category 1'</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>em<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>category1<span class="token punctuation">)</span>

    <span class="token keyword">const</span> category2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Category</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    category2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'My Category 2'</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>em<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>category2<span class="token punctuation">)</span>

    <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    product<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'My Product'</span>
    product<span class="token punctuation">.</span>categories <span class="token operator">=</span> <span class="token punctuation">[</span>category1<span class="token punctuation">,</span> category2<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="loading-many-to-many-relationship"><a href="#loading-many-to-many-relationship" class="header-anchor">#</a> Loading many-to-many relationship</h4> <p>Loading a <code>many-to-many</code> relationship is the same then loading other relationships:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">example</span><span class="token punctuation">(</span>@<span class="token function">repository</span><span class="token punctuation">(</span>Product<span class="token punctuation">)</span> productRepo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token keyword">await</span> product<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>With eager loading enabled on a relationship, you don't have to supply the <code>relation</code> option to <code>find()</code>, this is done automatically then. Please see &quot;Loading many-to-one / one-to-many related records&quot; chapter above for more information.</p> <h4 id="many-to-many-relationship-and-custom-properties"><a href="#many-to-many-relationship-and-custom-properties" class="header-anchor">#</a> many-to-many relationship and custom properties</h4> <p>Sometimes you want your <code>many-to-many</code> relationship to save some additional data about the relationship. A common example is a <code>sorting</code> (or <code>order</code>) column, which tells the application how it should sort the related records. In order to create custom properties for a <code>many-to-many</code> relationship, you need to create a extra entity with two <code>many-to-one</code> relationships pointing in both directions of the original <code>many-to-many</code> relationship:</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/ProductCategory.ts</span>
<span class="token comment">// this entity will have the custom properties and the relationships to the other entities</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> ManyToOne<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Product <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Product'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Category <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Category'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ProductCategory</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  productId<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  categoryId<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  sorting<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">ManyToOne</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Product<span class="token punctuation">,</span> <span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> product<span class="token punctuation">.</span>productCategories<span class="token punctuation">)</span>
  product<span class="token operator">:</span> Product

  @<span class="token function">ManyToOne</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Category<span class="token punctuation">,</span> <span class="token punctuation">(</span>category<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> category<span class="token punctuation">.</span>productCategories<span class="token punctuation">)</span>
  category<span class="token operator">:</span> Category
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/Product.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> OneToMany<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProductCategory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./ProductCategory'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">OneToMany</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ProductCategory<span class="token punctuation">,</span> <span class="token punctuation">(</span>productCategory<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> productCategory<span class="token punctuation">.</span>product<span class="token punctuation">)</span>
  productCategories<span class="token operator">:</span> ProductCategory<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/Category.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> OneToMany <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProductCategory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./ProductCategory'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">OneToMany</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ProductCategory<span class="token punctuation">,</span> <span class="token punctuation">(</span>productCategory<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> productCategory<span class="token punctuation">.</span>category<span class="token punctuation">)</span>
  productCategories<span class="token operator">:</span> ProductCategory<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div></div></div> <p>In the previous example we removed the <code>@ManyToMany</code> annotations from the <code>Product</code> and <code>Category</code> entities and replace it with a <code>one-to-many</code> relationship to the newly created <code>ProductCategory</code> entity, which has a <code>sorting</code> property. This way you can define more properties on a <code>many-to-many</code> relationship.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The <a href="https://github.com/typeorm/typeorm/blob/master/docs/many-to-many-relations.md" target="_blank" rel="noopener noreferrer">official TypeORM documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> contains more information about <code>many-to-many</code> relationships.</p></div> <h3 id="one-to-one-relationship"><a href="#one-to-one-relationship" class="header-anchor">#</a> one-to-one relationship</h3> <p>The last relationship we like to talk about in this guide is the <code>one-to-one</code> relationship. This relationship is where <em>A</em> contains only one instance of <em>B</em>, and <em>B</em> contains only one instance of <em>A</em>. None of them can have a relationship with other records (at least for that relationship). For example think about <em>one</em> <code>User</code> which has <em>one</em> <code>Profile</code>. To map this association we use the <code>@OneToOne</code> annotation on <em>one</em> of the entities (the owning side, which contains the related foreign key column):</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/User.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> OneToOne<span class="token punctuation">,</span> JoinColumn<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Profile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Profile'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  username<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Profile<span class="token punctuation">)</span>
  @<span class="token function">JoinColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  profile<span class="token operator">:</span> Profile
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/entity/Profile.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> OneToOne <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Profile</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  gender<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div></div></div> <p>We just created a mapping between the <code>User</code> and <code>Profile</code> entity. In this kind of relationship, the <code>@JoinColumn()</code> annotation is required, as it will deicide which table holds the foreign key column (in the above example the <code>user</code> table will have a <code>profileId</code>).</p> <p>Saving and updating the <code>one-to-one</code> relationship is the same then doing with a <code>many-to-one</code> / <code>one-to-many</code> relationship. Go back to this chapter to figure out how.</p> <p>The above example is a uni-directional association. To make it a bi-directional relationship, we need to add the <code>@OneToOne</code> annotation to the <code>Profile</code> entity too. This way a <code>Profile</code> instance can access its related <code>User</code> (changes are highlighted):</p> <div class="el-tabs el-tabs--top el-tabs--border-card"><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(-0px);"></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"></div><br><br><br><br></div><pre class="language-typescript"><code><span class="token comment">// src/entity/User.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> OneToOne<span class="token punctuation">,</span> JoinColumn<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Profile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Profile'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  username<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Profile<span class="token punctuation">,</span> <span class="token punctuation">(</span>profile<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> profile<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
  @<span class="token function">JoinColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  profile<span class="token operator">:</span> Profile
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></div> <div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none;"><div class="language-typescript line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"></div><div class="highlighted"></div><br><br><br><br><br><br><br><br><br><div class="highlighted"></div><div class="highlighted"></div><br><br></div><pre class="language-typescript"><code><span class="token comment">// src/entity/Profile.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Column<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> OneToOne <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> User <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./User'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Profile</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  gender<span class="token operator">:</span> <span class="token builtin">string</span>

  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> User<span class="token punctuation">,</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> user<span class="token punctuation">.</span>profile<span class="token punctuation">)</span>
  user<span class="token operator">:</span> User
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></div></div></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Head over to the <a href="https://github.com/typeorm/typeorm/blob/master/docs/one-to-one-relations.md" target="_blank" rel="noopener noreferrer">official one-to-one documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> from TypeORM to get further information about this kind of relationship.</p></div> <h2 id="next-steps"><a href="#next-steps" class="header-anchor">#</a> Next steps</h2> <p>Congratulation! You've just finished the database guide. Now you should be familiar with the basics and more advanced topics of ZenTS ORM TypeORM. Of course, there is much more to learn about the ORM then this guide covers. Don't forget to visit the <a href="https://github.com/typeorm/typeorm/tree/master/docs" target="_blank" rel="noopener noreferrer">official documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to learn more about the various topics. You can also check out TypeORM's <a href="https://github.com/typeorm/typeorm/blob/master/docs/using-cli.md" target="_blank" rel="noopener noreferrer">CLI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> if you like.</p> <p>The <a href="/guide/advancedguides/redis.html">next guide</a> will cover how to use <a href="https://redis.io" target="_blank" rel="noopener noreferrer">Redis<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in a ZenTS application. This feature is totally optional, so if you wish you can continue learning the three main concepts of a MVC application. The last part you're missing is the <strong>View</strong>, which will be covered in the <a href="/guide/advancedguides/templates.html">template guide</a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/sahachide/ZenTS/edit/master/docs/guide/advancedguides/database.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/2/2021, 7:29:38 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/guide/advancedguides/routing.html" class="prev">
        Routing
      </a></span> <span class="next"><a href="/guide/advancedguides/redis.html">
        Redis
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.ff0d6eb6.js" defer></script><script src="/assets/js/2.1831a849.js" defer></script><script src="/assets/js/16.d701e551.js" defer></script><script src="/assets/js/4.be0fa7c4.js" defer></script>
  </body>
</html>
